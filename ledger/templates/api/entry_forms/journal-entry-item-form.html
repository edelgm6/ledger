    {% load math_filters %}

    <form
        id="journal-entry-form"
        method="post"
        class="form-horizontal form-sm"
        hx-post="{% url 'journal-entries' transaction_id %}"
        hx-target="#table-and-form"
        hx-trigger="submit"
        hx-include="#transactions-filter-form"
    >

        {% csrf_token %}
        <input type="hidden" name="index" value="{{ index }}">
        <div class="row">
            <div class="col-12">
                <input type="submit" value="Submit" class="btn btn-primary mt-3" />
            </div>
        </div>
        <div class="row">
            <!-- Debit Formset Column -->
            <div class="col-md-6">
                <h3>Debits</h3>
                {{ debit_formset.management_form }}
                {% for form in debit_formset %}
                <div class="row">
                    <div class="col-md-6">
                        {{ form.id }}
                        <select
                            class="form-control select2 {% if form.account.errors %}is-invalid{% endif %}"
                            name="{{ form.account.html_name }}"
                            id="{{ form.account.auto_id }}"
                            tabindex="{{ forloop.counter|multiply:4|add:1 }}"
                            >
                            {% for option in form.account %}
                                {{ option }}
                            {% endfor %}
                        </select>
                        <div class="invalid-feedback">
                            {% for error in form.account.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <input
                            type="text"
                            class="form-control {% if form.amount.errors %}is-invalid{% endif %}"
                            name="{{ form.amount.html_name }}"
                            id="{{ form.amount.auto_id }}"
                            value="{% if form.amount.value == 0 %}0.00{% else %}{{ form.amount.value }}{% endif %}"
                            tabindex="{{ forloop.counter|multiply:4|add:2 }}"
                            {% if not autofocus_debit %}autofocus{% endif %}
                        >
                        <div class="invalid-feedback">
                            {% for error in form.amount.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Credit Formset Column -->
            <div class="col-md-6">
                <h3>Credits</h3>
                {{ credit_formset.management_form }}
                {% for form in credit_formset %}
                <div class="row">
                    <div class="col-md-6">
                        {{ form.id }}
                        <select
                            class="form-control select2 {% if form.account.errors %}is-invalid{% endif %}"
                            name="{{ form.account.html_name }}"
                            id="{{ form.account.auto_id }}"
                            tabindex="{{ forloop.counter|multiply:4|add:3 }}"
                            >
                            {% for option in form.account %}
                                {{ option }}
                            {% endfor %}
                        </select>
                        <div class="invalid-feedback">
                            {% for error in form.account.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <input
                            type="text"
                            class="form-control {% if form.amount.errors %}is-invalid{% endif %}"
                            name="{{ form.amount.html_name }}"
                            id="{{ form.amount.auto_id }}"
                            value="{% if form.amount.value == 0 %}0.00{% else %}{{ form.amount.value }}{% endif %}"
                            tabindex="{{ forloop.counter|multiply:4|add:4 }}"
                            {% if autofocus_debit %}autofocus{% endif %}
                        >
                        <div class="invalid-feedback">
                            {% for error in form.amount.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </form>
